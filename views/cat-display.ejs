<!DOCTYPE html>
<html lang="en">

<html>

<head>
    <meta charset="utf-8">
    <title>Cats for Adoption</title>
    <link rel="stylesheet" href="cat-display.css">
</head>

<body>
    <h1>Meet the Cats!</h1>
    <p class="intro">Browse the cats we have available for adoption below.</p>
    <input type="text" id="searchBox" placeholder="Search by name or age">

    <form id="genderFilter">
        <input type="radio" value="female" name="gender">
        <label for="femaleCat">Female</label>
        <input type="radio" value="male" name="gender">
        <label for="maleCat">Male</label>
    </form>

    <button class="btn" style="padding: 10px;">Clear Search</button>

    <div class="container" id="catList">
        <% if (cats.length > 0 ) { %>
            <% cats.forEach(cat => { %>
                <a href="/cats/<%= cat._id %>"><div class="cat-card">
                    <img src="/images/<%= cat.imageUrl %>">
                    <h2><%= cat.name %></h2>
                    <p class="cat-info"><%= cat.gender %></p>
                    <p class="cat-info"><%= Math.floor(cat.ageMonths / 12) %> Years and <%= (cat.ageMonths % 12) %> months old</p>
                </div></a>
            <% }) %>
        <% } else { %>
            <p class="intro">No Cats Found :(</p>
        <% } %>
    </div>

    <!-- links back to index page -->
    <a class="btn" href="/">Go Back Home</a>

<script>
    document.querySelectorAll('input[name="gender"]').forEach(radio => {
        radio.addEventListener('change', async () => {
            const gender = radio.value;
             console.log(gender);

            const res = await fetch(`/cats?gender=${gender}`);
            const html = await res.text();

            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const newList = doc.querySelector('#catList');
            document.querySelector('#catList').innerHTML = newList.innerHTML;
        });
    });
</script>

</body>
</html>