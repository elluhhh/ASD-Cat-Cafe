<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Food Management - Staff Portal</title>
        <link rel="stylesheet" type="text/css" href="/css/style.css">
        <style>
            .form-container {
                background: #fff;
                padding: 20px;
                margin: 20px 0;
                border-radius: 10px;
                border: 1px solid var(--border);
            }
            .form-row {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                margin-bottom: 10px;
            }
            .form-row input, .form-row select {
                flex: 1;
                min-width: 150px;
            }
            button.delete {
                background: var(--danger);
                color: white;
            }
            button.edit {
                background: var(--success);
                color: white;
            }
        </style>
    </head>
    <body>
        <h1>Staff Food Management</h1>
        <p>‚Üê <a href="/">Home</a> | <a href="/foodManagement/seed">Reset Sample Data</a></p>
        
        <!-- Summary Statistics -->
        <div style="display: flex; gap: 20px; margin: 20px 0;">
            <div style="background: #fff; padding: 15px; border-radius: 10px; text-align: center;">
                <h3><%= foods.length %></h3>
                <p>Total Items</p>
            </div>
            <div style="background: #fff; padding: 15px; border-radius: 10px; text-align: center;">
                <h3><%= foods.filter(f => f.status === 'Available').length %></h3>
                <p>Available</p>
            </div>
            <div style="background: #fff; padding: 15px; border-radius: 10px; text-align: center;">
                <h3><%= foods.filter(f => f.status === 'Unavailable').length %></h3>
                <p>Unavailable</p>
            </div>
            <div style="background: #fff; padding: 15px; border-radius: 10px; text-align: center;">
                <h3><%= foods.filter(f => f.stock < 10).length %></h3>
                <p>Low Stock</p>
            </div>
        </div>

        <!-- Add New Item Form (U117) -->
        <div class="form-container">
            <h2>‚ûï Add New Menu Item</h2>
            <form action="/foodManagement/add" method="POST">
                <div class="form-row">
                    <input type="text" name="name" placeholder="Item Name" required>
                    <select name="category" required>
                        <option value="">Select Category</option>
                        <option value="food">Food</option>
                        <option value="drink">Drink</option>
                    </select>
                    <input type="number" name="price" placeholder="Price" step="0.01" min="0" required>
                </div>
                <div class="form-row">
                    <input type="text" name="description" placeholder="Description" required>
                    <input type="number" name="stock" placeholder="Stock Quantity" min="0" required>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="vegan"> Vegan Option
                    </label>
                </div>
                <button type="submit" class="btn primary">Add Item</button>
            </form>
        </div>

        <!-- All Menu Items Table -->
        <h2>üìã All Menu Items</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th>Stock</th>
                    <th>Vegan</th>
                    <th>Description</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% if (foods.length === 0) { %>
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 20px;">
                            No menu items found. <a href="/foodManagement/seed">Add sample data</a>
                        </td>
                    </tr>
                <% } else { %>
                    <% foods.forEach(food => { %>
                    <tr style="<%= food.status === 'Unavailable' ? 'opacity: 0.6;' : '' %>">
                        <td><strong><%= food.name %></strong></td>
                        <td><%= food.category.toUpperCase() %></td>
                        <td>$<%= food.price.toFixed(2) %></td>
                        <td>
                            <span style="color: <%= food.status === 'Available' ? 'green' : 'red' %>; font-weight: bold;">
                                <%= food.status %>
                            </span>
                        </td>
                        <td style="<%= food.stock < 10 ? 'color: red; font-weight: bold;' : '' %>">
                            <%= food.stock %>
                        </td>
                        <td><%= food.vegan ? 'üå± Yes' : 'No' %></td>
                        <td><%= food.description %></td>
                        <td>
                            <form action="/foodManagement/delete/<%= food._id %>" method="POST" style="display: inline;">
                                <button type="submit" class="btn small delete" 
                                        onclick="return confirm('Delete <%= food.name %>?')">
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    <% }); %>
                <% } %>
            </tbody>
        </table>
    </body>
</html>